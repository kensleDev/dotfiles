<script lang="ts">
  import Button from "@/components/ui/button/button.svelte";
  import {
    Card,
    CardContent,
    CardDescription,
    CardHeader,
    CardTitle,
  } from "@/components/ui/card";
  import { cn } from "@/utils";

  import { Check } from "@lucide/svelte";

  type Props = {
    plans: Array<{
      name: string;
      price: string;
      period: string;
      description: string;
      features: string[];
      buttonText: string;
      buttonVariant: "default" | "outline" | "link";
      buttonLink?: string;
    }>;
    class?: string;
    showFreePlan?: boolean;
    children?: () => any;
  };

  let {
    plans,
    class: className,
    showFreePlan = true,
    children,
  }: Props = $props();

  let displayedPlans = showFreePlan
    ? plans
    : plans.filter((plan: any) => plan.name !== "Free");
</script>

<div
  class={cn(
    "grid grid-cols-1 md:grid-cols-2 gap-6 md:max-w-4xl mx-auto md:px-x-section",
    displayedPlans.length === 1 && "md:grid-cols-1 max-w-full w-full",
    className
  )}
>
  {#each displayedPlans as plan}
    <Card class="flex flex-col opactiy-50 w-full bg-green-400">
      <CardHeader>
        <CardTitle class="text-2xl">{plan.name}</CardTitle>
        <div class="text-3xl font-bold mr-2">
          {plan.price}<span class="text-sm font-normal ml-2">{plan.period}</span
          >
        </div>
        <CardDescription>{plan.description}</CardDescription>
      </CardHeader>

      <CardContent class="flex-1">
        <ul class="space-y-2">
          {#each plan.features as feature}
            <li class="flex items-center">
              <Check class="h-4 w-4 text-green-500 mr-2" />
              {feature}
            </li>
          {/each}
        </ul>

        {#if children}
          <div class="w-full mx-auto mt-12">
            {#if plan.name === "Pro"}
              {@render children()}
            {:else}
              <Button
                href={plan.buttonLink}
                variant={plan.buttonVariant}
                class="w-full mt-6 "
              >
                {plan.buttonText}
              </Button>
            {/if}
          </div>
          <!-- {:else if plan.buttonLink}
          <Button
            href={plan.buttonLink}
            variant={plan.buttonVariant}
            class="w-full mt-6">{plan.buttonText}</Button
          >
        {:else}
          <Button variant={plan.buttonVariant} class="w-full mt-6 ">
            {plan.buttonText}
          </Button> -->
        {/if}
      </CardContent>
    </Card>
  {/each}
</div>
